<head>
    <title>Socket.io Boilerplate</title>
</head>

<body>
    <div id="userAuth">

        <form id="inputForm" onkeydown="return event.key != 'Enter';">
            Room Code: <input id="ac" onclick="return false" type="text" name="roomCode" value=""><br>
        </form>
        <button id="enterBtn">Enter</button>
    
        <div id="enterStatus" style="display:none;"></div>
        <div id="roomStatus"></div>
    </div>
    <div id="nameSelect" style="display:none;">
        
        Choose your nickname
        <form id="inputForm2" onkeydown="return event.key != 'Enter';">
            Room Code: <input id="nick" onclick="return false" type="text" name="nickInput" value=""><br>
        </form>
        <button id="nickEnterBtn">Enter</button>
    
        <div id="nickSatus" style="display:none;"></div>
    </div>
    <div id="foo">Server Status: ðŸ”´</div>
</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.1/socket.io.min.js" integrity="sha384-fKnu0iswBIqkjxrhQCTZ7qlLHOFEgNkRmK2vaO/LbTZSXdJfAu6ewRBdwHPhBo/H" crossorigin="anonymous"></script>
<script>
    const log = console.log.bind(console);
    const socket = io('http://86.2.10.33:3221/');
    log("%cSocket.io Boilerplate", "color:blue; font-size:50px");

    // await for assignment
    var roomCode;

    socket.on('connect', () => {
        document.getElementById('foo').innerHTML = 'Server Status: âœ…';
    });
    socket.on('disconnect', () => {
        document.getElementById('foo').innerHTML = 'Server Status: ðŸ”´';
    });
    socket.on('roomConnect', () => {
        // window.location.href = window.location.href + `?code=${roomCode}`;
        document.getElementById('roomStatus').innerHTML = '';
    });
    socket.on('roomError', () => {
        document.getElementById('roomStatus').innerHTML = 'That room does not exist, Please try again or fresh the browser..';
    });

    document.getElementById('enterBtn').addEventListener('click', () => {

        var rCode = document.getElementById('ac').value;
        if (rCode) {
            var room = {
            roomCode: document.getElementById('ac').value
            };
            var user = {
                userType: 'student'
            };
            socket.emit('roomListener', {room, user});
            document.getElementById('userAuth').style.display = 'none';
            document.getElementById('nameSelect').style.display = 'inline-block';
        } else if (!rCode) {
            document.getElementById('enterStatus').style.display = 'inline-block';
            document.getElementById('enterStatus').innerHTML = 'Please enter a room code';
        };
    });

    document.getElementById('nickEnterBtn').addEventListener('click', () => {

        var nick = document.getElementById('nick').value;
        if (nick) {
            socket.emit('nickListener', {nick});
        } else if (!nick) {
            document.getElementById('nickSatus').style.display = 'inline-block';
            document.getElementById('nickSatus').innerHTML = 'Please enter a nickname';
        };
    });
</script>
